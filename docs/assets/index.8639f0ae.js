var t=Object.defineProperty,e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s,h=(t,e,i)=>(r(t,"symbol"!=typeof e?e+"":e,i),i);export function __vite_legacy_guard(){import("data:text/javascript,")}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const a="markerClick",n="dragging",o="dragend",l="mousemove",p="mouseleave",d="undefined"!=typeof window,c=Object.prototype.toString;function u(t){return"string"==typeof t||t instanceof String}function m(t){return"number"==typeof t||"[object Number]"===c.call(t)}let f=!1;if(d)try{const V=Object.defineProperty({},"once",{get(){f=!0}});window.addEventListener("test",null,V)}catch(Q){}class g{constructor(t,e,i,s){var r;h(this,"node"),h(this,"type"),h(this,"handler"),h(this,"options"),this.node=t,this.type=e,this.handler=i,this.options=s,this.options=!0===(r=s)||!1===r||"[object Boolean]"===c.call(r)?s:!!s&&(f&&s),t.addEventListener(e,i,this.options)}destroy(){this.handler&&(this.node.removeEventListener(this.type,this.handler,this.options),this.node=null,this.handler=null,this.options=null)}}const v=new Map;function y(t,e){return v.has(t)||v.set(t,[]),v.get(t).push(e),e}function C(t){v.has(t)&&(v.get(t).forEach((t=>t.destroy())),v.delete(t))}function b(t,e,i,s,r){const h=new g(e,i,s,r);return t&&y(t,h),h}const E=/([\w-]+)?(?:#([\w-]+))?((?:\.(?:[\w-]+))*)/;function x(t,e,i,s=""){let r=[];t&&(r=E.exec(t)||[]);const h=document.createElement(r[1]||"div");return r[2]&&(h.id=r[3]),r[3]&&(h.className=r[3].replace(/\./g,` ${s}`).trim()),e&&Object.keys(e).forEach((t=>{const i=e[t];void 0!==i&&(/^on\w+$/.test(t)?h[t]=i:"selected"===t?i&&h.setAttribute(t,"true"):h.setAttribute(t,i))})),i&&(u(i)?h.innerHTML=i:i.forEach((t=>h.appendChild(t)))),h}function w(t){t&&(t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t))}const M="http://www.w3.org/2000/svg";class _{constructor(t,e,i){h(this,"fn"),h(this,"context"),h(this,"once"),this.fn=t,this.context=e,this.once=i,this.once=i||!1}}class k{constructor(t){h(this,"el"),h(this,"rect"),h(this,"update",(()=>{this.rect=this.el.getBoundingClientRect()})),this.el=t,this.rect={}}get width(){return this.tryUpdate(this.rect.width),this.rect.width}get height(){return this.tryUpdate(this.rect.height),this.rect.height}get x(){return this.tryUpdate(this.rect.left),this.rect.left}get y(){return this.tryUpdate(this.rect.top),this.rect.top}get bottom(){return this.rect.bottom}get right(){return this.rect.right}get changed(){const t=this.el.getBoundingClientRect(),e=t.top!==this.rect.top||t.left!==this.rect.left||t.width!==this.rect.width||t.height!==this.rect.height;return e&&(this.rect=t),e}tryUpdate(t){t||this.update()}destroy(){this.el=null,this.rect=null}}function H(t,e,i,s,r){let h;return h=e&&!u(e)?e:x(e,i,s,r),t&&t.appendChild(h),h}class A{constructor(t,e,i,s,r){h(this,"el"),this.el=H(t,e,i,s,r)}destroy(){w(this.el),C(this)}}class P{constructor(t,e,i,s){h(this,"el"),h(this,"start"),h(this,"move"),h(this,"end"),h(this,"pending",!1),h(this,"lastEv"),h(this,"downHandler",(t=>{t.preventDefault(),this.el.setPointerCapture(t.pointerId),this.el.addEventListener("pointermove",this.moveHandler,!0),this.start(t)})),h(this,"moveHandler",(t=>{t.preventDefault(),this.lastEv=t,this.pending||(this.pending=!0,requestAnimationFrame(this.handlerMove))})),h(this,"handlerMove",(()=>{this.move(this.lastEv),this.pending=!1})),h(this,"upHandler",(t=>{t.preventDefault(),this.el.releasePointerCapture(t.pointerId),this.el.removeEventListener("pointermove",this.moveHandler,!0),this.end&&this.end(t)})),this.el=t,this.start=e,this.move=i,this.end=s,t.addEventListener("pointerdown",this.downHandler,!0),t.addEventListener("pointerup",this.upHandler,!0),t.addEventListener("pointercancel",this.upHandler,!0)}destroy(){this.el&&(this.el.removeEventListener("pointerdown",this.downHandler,!0),this.el.removeEventListener("pointerup",this.upHandler,!0),this.el.removeEventListener("pointercancel",this.upHandler,!0),this.el.removeEventListener("pointermove",this.moveHandler,!0),this.start=null,this.move=null,this.end=null,this.lastEv=null,this.el=null)}}function $(t,e=2,i="0"){if((t=String(t)).length>=e)return t;for(let s=0,r=e-t.length;s<r;s++)t=i+t;return t}function z(t,e=0,i=1){return Math.max(Math.min(t,i),e)}function L(t,e){let i=!1,s=!0,r=null;return function(){if(r=arguments,s)return s=!1,t.apply(e,r);i||(i=!0,requestAnimationFrame((()=>{t.apply(e,r),i=!1})))}}class B extends A{constructor(t,e,i,s,r){super(t,".ppbar_chapter_i"),this.start=i,this.end=s,this.title=r,this.duration=0;const h=this.realEl=this.el.appendChild(x(".ppbar_chapter_i_w"));this.bufferedEl=h.appendChild(x(".ppbar_chapter_i_b")),this.hoverEl=h.appendChild(x(".ppbar_chapter_i_h")),this.playedEl=h.appendChild(x(".ppbar_chapter_i_p")),this.update(i,s,e,r)}update(t,e,i,s){this.start=t,this.end=e,this.duration=e-t,this.title=s||"",this.updateFlex(i)}updateFlex(t){this.el.style.flex=String(Math.max(0,this.duration/t))}match(t){return t>=this.start&&t<=this.end}updateHover(t){return this.setBar(t,this.hoverEl)}updateBuffer(t){return this.setBar(t,this.bufferedEl)}updatePlayed(t){return this.setBar(t,this.playedEl)}setBar(t,e){const i=this.match(t);return e.style.transform=`scaleX(${i?(t-this.start)/this.duration:t>this.end?1:0})`,i}}let S=0;class j extends A{constructor(t,e,i,s){super(t,".ppbar_heat_i");const r=document.createElementNS(M,"svg");this.pathEl=document.createElementNS(M,"path");const h=document.createElementNS(M,"defs"),a=document.createElementNS(M,"clipPath"),n=document.createElementNS(M,"rect");r.setAttribute("viewBox","0 0 1000 100"),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("width","100%"),a.setAttribute("id",`ppb${S}`),n.setAttribute("clip-path",`url(#ppb${S})`),n.setAttribute("fill","white"),n.setAttribute("fill-opacity","0.2"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("x","0"),n.setAttribute("y","0"),a.appendChild(this.pathEl),h.appendChild(a),r.appendChild(h),r.appendChild(n),S++,e&&i&&this.update(e,i,s),this.el.appendChild(r)}update(t,e,i){const s=["M0 100"];let r,h,a,n=[0,100],o=[],l=0,p=0;const d=t=>{if(t)return[t[0],100*(1-t[1]/e)]};t.forEach(((e,i)=>{o=r||d(e),r=d(t[i+1])||[1e3,100];const c=this.slope(n,r);h=-.3*(r[0]-o[0]),a=h*c*.6,s.push(`C ${(n[0]-l).toFixed(1)} ${(n[1]-p).toFixed(1)}, ${(o[0]+h).toFixed(1)} ${(o[1]+a).toFixed(1)}, ${o[0].toFixed(1)} ${o[1].toFixed(1)}`),l=h,p=a,n=o})),s.push(`C ${(o[0]-l).toFixed(1)} ${(o[1]-p).toFixed(1)}, 1000 100, 1000 100`),this.pathEl.setAttributeNS(null,"d",s.join(" ")),this.el.style.flex=i||"1"}slope(t,e){return(e[1]-t[1])/(e[0]-t[0])}}class O extends A{constructor(t,e,i){var s,r;if(super(e,".ppbar_marker_i"),this.cfg=i,this.tipEl=this.el.appendChild(x(".ppbar_marker_i_tip")),i.title&&(this.title=i.title,this.tipEl.textContent=i.title),this.el.appendChild(x(".ppbar_marker_i_d")),i.image){const t=new Image(null==(s=i.size)?void 0:s[0],null==(r=i.size)?void 0:r[1]);t.src=i.image,this.el.appendChild(t)}else i.el&&(i.size&&i.size.length>1&&(i.el.style.width=`${i.size[0]}px`,i.el.style.height=`${i.size[1]}px`),this.el.appendChild(i.el));b(this,this.el,"click",(()=>{t.emit(a,this.cfg)})),this.time=i.time,this.update(t.duration)}update(t){t&&(this.time<0?this.el.style.right=-this.time/t*100+"%":this.el.style.left=this.time/t*100+"%")}}class I extends A{constructor(t,e){super(t,".ppbar_thumb"),this.prog=e,this.opts={start:0,gap:10,col:5,row:5,width:160,height:90,images:[]},this.imgEl=this.el.appendChild(x(".ppbar_thumb_img")),this.titleEl=this.el.appendChild(x(".ppbar_thumb_title")),this.timeEl=this.el.appendChild(x(".ppbar_thumb_time")),this.rect=y(this,new k(this.el)),this.updateOptions(this.prog.config.thumbnail)}updateOptions(t){const e=Object.assign(this.opts,t);e.images.length?(this.imgEl.style.display="block",this.titleEl.style.width=this.imgEl.style.width=`${e.width}px`,this.imgEl.style.height=`${e.height}px`,this.thumbImgPrePic=e.col*e.row,this.ssGapRatio=e.start/e.gap):this.imgEl.style.display="none",this.rect.update()}update(t,e,i){if(this.opts.images.length){const e=this.getCurrentThumb(t);e&&(this.imgEl.style.backgroundImage=`url(${e.url})`,this.imgEl.style.backgroundPosition=`-${e.x}px -${e.y}px`)}else this.rect.update();const s=this.prog.live;this.timeEl.textContent=`${s?"-":""}${function(t){if(!isFinite(t)||isNaN(t))return"";if(!t)return"0:00";const e=t<0;let i;return e&&(t*=-1),i=(t=Math.round(t))<60?`0:${$(t)}`:t<3600?`${~~(t/60)}:${$(t%60)}`:`${~~(t/3600)}:${$(~~(t%3600/60))}:${$(t%60)}`,e&&(i=`-${i}`),i}(s?this.prog.duration-t:t)}`;const{markers:r,chapters:h}=this.prog;let a;if(r.length)for(let o,l=0,p=r.length;l<p;l++)if(o=r[l],t>=o.time&&t<o.time+2){a=o.title;break}if(!a&&h.length)for(let o,l=0,p=h.length;l<p;l++)if(o=h[l],t>=o.start&&t<=o.end){a=o.title;break}this.titleEl.textContent=a||"";const n=this.rect.width/2;this.el.style.left=`${z(e-n,0,Math.max(0,i-2*n))}px`}getCurrentThumb(t){const e=0|Math.max(t/this.opts.gap-this.ssGapRatio,0),i=this.opts.images[e/this.thumbImgPrePic|0];if(!i)return;return{url:i,x:e%this.opts.col*this.opts.width,y:~~(e%this.thumbImgPrePic/this.opts.row)*this.opts.height}}}var D="./assets/m1.5e10f6e3.png",N="./assets/m2.df4d84ec.png",F="./assets/m3.3c59fef5.png";const T=document.getElementById("c"),R=document.getElementById("buffer"),Y=document.getElementById("rotate"),U=document.getElementById("live"),W=document.getElementById("youtube"),q=document.getElementById("bilibili"),G={dot:!0,duration:600,live:!1,chapters:[{time:100,title:"chapter-a"},{time:280,title:"chapter-b"},{time:510,title:"chapter-c"},{title:"chapter-d"}],markers:[{time:150,title:"title1",image:D,size:[32,34]},{time:300,title:"title2",image:N,size:[32,34]},{time:550,title:"title3",image:F,size:[32,34]}],heatMap:{points:[9592,9692,10063,41138,30485,23905,10966.5,10316.5,8533.5,7249,7181,6813,5929,18046.5,8817,3684.5,4863.5,7818,11122,11977.5,12045.5,6882,8616,3389.5,2791.5,2378,2415,3561.5,4563.5,5351,5166,3649.5,3817.5,6808,3503,2831.5,2617.5,2401,2149,2478.5,2498.5,2311.5,1843.5,1800,2101,2002.5,2882.5,3380,3880,3966,3257,8804,5440,6468,6432,3885,3611,7348,11954,12317,5834,1549.5,1658.5,1649,2053,3831.5,6050.5,7764,8290,8549,5757,1898,1393,1263.5,1356.5,2841,5774,4294,1798,1260.5],defaultDuration:7.5},thumbnail:{images:["./assets/t1.3b083484.jpg","./assets/t2.b7afa5ab.jpg","./assets/t3.4b7b4485.jpg"]}},X={dot:!0,chapters:[{time:100,title:"chapter-a"},{time:280,title:"chapter-b"},{time:510,title:"chapter-c"},{title:"chapter-d"}],markers:[],heatMap:{points:[9592,9692,10063,41138,30485,23905,10966.5,10316.5,8533.5,7249,7181,6813,5929,18046.5,8817,3684.5,4863.5,7818,11122,11977.5,12045.5,6882,8616,3389.5,2791.5,2378,2415,3561.5,4563.5,5351,5166,3649.5,3817.5,6808,3503,2831.5,2617.5,2401,2149,2478.5,2498.5,2311.5,1843.5,1800,2101,2002.5,2882.5,3380,3880,3966,3257,8804,5440,6468,6432,3885,3611,7348,11954,12317,5834,1549.5,1658.5,1649,2053,3831.5,6050.5,7764,8290,8549,5757,1898,1393,1263.5,1356.5,2841,5774,4294,1798,1260.5],hoverShow:!0,defaultDuration:7.5}},K={dot:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" preserveAspectRatio="xMidYMid meet"><defs><clipPath id="__lottie_element_25"><rect width="18" height="18" x="0" y="0"></rect></clipPath></defs><g clip-path="url(#__lottie_element_25)"><g transform="matrix(1,0,0,1,8.937000274658203,8.25)" opacity="0.14" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0.07500000298023224,1.2130000591278076)"><path fill="rgb(251,114,153)" fill-opacity="1" d=" M9,-3.5 C9,-3.5 9,3.5 9,3.5 C9,5.707600116729736 7.207600116729736,7.5 5,7.5 C5,7.5 -5,7.5 -5,7.5 C-7.207600116729736,7.5 -9,5.707600116729736 -9,3.5 C-9,3.5 -9,-3.5 -9,-3.5 C-9,-5.707600116729736 -7.207600116729736,-7.5 -5,-7.5 C-5,-7.5 5,-7.5 5,-7.5 C7.207600116729736,-7.5 9,-5.707600116729736 9,-3.5z"></path></g></g><g transform="matrix(1,0,0,1,9.140999794006348,8.67199993133545)" opacity="0.28" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,-0.1509999930858612,0.7990000247955322)"><path fill="rgb(251,114,153)" fill-opacity="1" d=" M8,-3 C8,-3 8,3 8,3 C8,4.931650161743164 6.431650161743164,6.5 4.5,6.5 C4.5,6.5 -4.5,6.5 -4.5,6.5 C-6.431650161743164,6.5 -8,4.931650161743164 -8,3 C-8,3 -8,-3 -8,-3 C-8,-4.931650161743164 -6.431650161743164,-6.5 -4.5,-6.5 C-4.5,-6.5 4.5,-6.5 4.5,-6.5 C6.431650161743164,-6.5 8,-4.931650161743164 8,-3z"></path></g></g><g transform="matrix(0.9883429408073425,-0.7275781631469727,0.6775955557823181,0.920446515083313,7.3224687576293945,-0.7606706619262695)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(0.9937776327133179,-0.11138220876455307,0.11138220876455307,0.9937776327133179,-2.5239999294281006,1.3849999904632568)"><path fill="rgb(0,0,0)" fill-opacity="1" d=" M0.75,-1.25 C0.75,-1.25 0.75,1.25 0.75,1.25 C0.75,1.663925051689148 0.4139249920845032,2 0,2 C0,2 0,2 0,2 C-0.4139249920845032,2 -0.75,1.663925051689148 -0.75,1.25 C-0.75,1.25 -0.75,-1.25 -0.75,-1.25 C-0.75,-1.663925051689148 -0.4139249920845032,-2 0,-2 C0,-2 0,-2 0,-2 C0.4139249920845032,-2 0.75,-1.663925051689148 0.75,-1.25z"></path></g></g><g transform="matrix(1.1436611413955688,0.7535901665687561,-0.6317168474197388,0.9587040543556213,16.0070743560791,2.902894973754883)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(0.992861807346344,0.1192704513669014,-0.1192704513669014,0.992861807346344,-2.5239999294281006,1.3849999904632568)"><path fill="rgb(0,0,0)" fill-opacity="1" d=" M0.75,-1.25 C0.75,-1.25 0.75,1.25 0.75,1.25 C0.75,1.663925051689148 0.4139249920845032,2 0,2 C0,2 0,2 0,2 C-0.4139249920845032,2 -0.75,1.663925051689148 -0.75,1.25 C-0.75,1.25 -0.75,-1.25 -0.75,-1.25 C-0.75,-1.663925051689148 -0.4139249920845032,-2 0,-2 C0,-2 0,-2 0,-2 C0.4139249920845032,-2 0.75,-1.663925051689148 0.75,-1.25z"></path></g></g><g transform="matrix(1,0,0,1,8.890999794006348,8.406000137329102)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0.09099999815225601,1.1009999513626099)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M7,-3 C7,-3 7,3 7,3 C7,4.379749774932861 5.879749774932861,5.5 4.5,5.5 C4.5,5.5 -4.5,5.5 -4.5,5.5 C-5.879749774932861,5.5 -7,4.379749774932861 -7,3 C-7,3 -7,-3 -7,-3 C-7,-4.379749774932861 -5.879749774932861,-5.5 -4.5,-5.5 C-4.5,-5.5 4.5,-5.5 4.5,-5.5 C5.879749774932861,-5.5 7,-4.379749774932861 7,-3z"></path><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="4" stroke="rgb(0,0,0)" stroke-opacity="1" stroke-width="1.5" d=" M7,-3 C7,-3 7,3 7,3 C7,4.379749774932861 5.879749774932861,5.5 4.5,5.5 C4.5,5.5 -4.5,5.5 -4.5,5.5 C-5.879749774932861,5.5 -7,4.379749774932861 -7,3 C-7,3 -7,-3 -7,-3 C-7,-4.379749774932861 -5.879749774932861,-5.5 -4.5,-5.5 C-4.5,-5.5 4.5,-5.5 4.5,-5.5 C5.879749774932861,-5.5 7,-4.379749774932861 7,-3z"></path></g></g><g transform="matrix(1,0,0,1,8.89900016784668,8.083999633789062)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,-2.5239999294281006,1.3849999904632568)"><path fill="rgb(0,0,0)" fill-opacity="1" d=" M0.875,-1.125 C0.875,-1.125 0.875,1.125 0.875,1.125 C0.875,1.607912540435791 0.48291251063346863,2 0,2 C0,2 0,2 0,2 C-0.48291251063346863,2 -0.875,1.607912540435791 -0.875,1.125 C-0.875,1.125 -0.875,-1.125 -0.875,-1.125 C-0.875,-1.607912540435791 -0.48291251063346863,-2 0,-2 C0,-2 0,-2 0,-2 C0.48291251063346863,-2 0.875,-1.607912540435791 0.875,-1.125z"></path></g></g><g transform="matrix(1,0,0,1,14.008999824523926,8.083999633789062)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,-2.5239999294281006,1.3849999904632568)"><path fill="rgb(0,0,0)" fill-opacity="1" d=" M0.8999999761581421,-1.100000023841858 C0.8999999761581421,-1.100000023841858 0.8999999761581421,1.100000023841858 0.8999999761581421,1.100000023841858 C0.8999999761581421,1.596709966659546 0.4967099726200104,2 0,2 C0,2 0,2 0,2 C-0.4967099726200104,2 -0.8999999761581421,1.596709966659546 -0.8999999761581421,1.100000023841858 C-0.8999999761581421,1.100000023841858 -0.8999999761581421,-1.100000023841858 -0.8999999761581421,-1.100000023841858 C-0.8999999761581421,-1.596709966659546 -0.4967099726200104,-2 0,-2 C0,-2 0,-2 0,-2 C0.4967099726200104,-2 0.8999999761581421,-1.596709966659546 0.8999999761581421,-1.100000023841858z"></path></g></g></g></svg>',chapters:[],markers:[{time:150,title:"title1",image:D,size:[32,34]},{time:300,title:"title2",image:N,size:[32,34]},{time:550,title:"title3",image:F,size:[32,34]}],heatMap:{points:[9592,9692,10063,41138,30485,23905,10966.5,10316.5,8533.5,7249,7181,6813,5929,18046.5,8817,3684.5,4863.5,7818,11122,11977.5,12045.5,6882,8616,3389.5,2791.5,2378,2415,3561.5,4563.5,5351,5166,3649.5,3817.5,6808,3503,2831.5,2617.5,2401,2149,2478.5,2498.5,2311.5,1843.5,1800,2101,2002.5,2882.5,3380,3880,3966,3257,8804,5440,6468,6432,3885,3611,7348,11954,12317,5834,1549.5,1658.5,1649,2053,3831.5,6050.5,7764,8290,8549,5757,1898,1393,1263.5,1356.5,2841,5774,4294,1798,1260.5],defaultDuration:7.5}},J=new class extends class extends class{constructor(){h(this,"_events",Object.create(null)),h(this,"_eventsCount",0)}emitAsync(t,e,i=0){setTimeout((()=>this.emit(t,e)),i)}emit(t,e){if(!this._events[t])return;const i=this._events[t];if(i.fn)i.once&&this.off(t,i.fn,void 0,!0),i.fn.call(i.context,e);else{const s=i.length;for(let r=0;r<s;r++)i[r].once&&this.off(t,i[r].fn,void 0,!0),i[r].fn.call(i[r].context,e)}}on(t,e,i,s=!1){if("function"!=typeof e)throw new TypeError("The listener must be a function");const r=new _(e,i||this,s);return this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],r]:this._events[t].push(r):(this._events[t]=r,this._eventsCount++),{destroy:this.off.bind(this,t,e)}}once(t,e,i){return this.on(t,e,i,!0)}off(t,e,i,s){if(!t)return this._events=Object.create(null),this._eventsCount=0,this;if(!this._events[t])return this;if(!e)return this.clearEvent(t),this;const r=this._events[t],h=[];if(r.fn)r.fn!==e||s&&!r.once||i&&r.context!==i||this.clearEvent(t);else{for(let t=0,a=r.length;t<a;t++)(r[t].fn!==e||s&&!r[t].once||i&&r[t].context!==i)&&h.push(r[t]);h.length?this._events[t]=1===h.length?h[0]:h:this.clearEvent(t)}return this}clearEvent(t){0==--this._eventsCount?this._events=Object.create(null):delete this._events[t]}}{constructor(t,e,i,s,r){super(),h(this,"el"),this.el=H(t,e,i,s,r)}destroy(){w(this.el),C(this)}}{constructor(t,h){super(t,".ppbar"),this.duration=0,this.rotate=0,this.live=!1,this.chapters=[],this.markers=[],this.headMaps=[],this.curChapter=0,this.dragging=!1,this.onMouseleave=()=>{this.emit(p),setTimeout((()=>{this.prevActiveChapter&&(this.prevActiveChapter.style.transform="",this.prevActiveChapter=void 0),this.prevActiveHeat&&(this.prevActiveHeat.style.transform="",this.prevActiveHeat=void 0)}))},this.onDragStart=t=>{this.dragging=!0,this.updateSize(),this.onDragging(t)},this.onDragging=t=>{const e=this.getLeft(t),i=this.getCurrentTime(e);this.updatePlayed(i,!0),this.updateHover(i,e),this.emit(n,i)},this.config=((t,h)=>{for(var a in h||(h={}))i.call(h,a)&&r(t,a,h[a]);if(e)for(var a of e(h))s.call(h,a)&&r(t,a,h[a]);return t})({},h);const{duration:a,live:l,rotate:d}=this.config;if(this.rotate=d||0,this.updateDuration(a),this.live=l,this.heatEl=this.el.appendChild(x(".ppbar_heat")),this.chapterEl=this.el.appendChild(x(".ppbar_chapter")),this.markerEl=this.el.appendChild(x(".ppbar_marker")),this.dotEl=this.el.appendChild(x(".ppbar_dot")),this.updateDot(),this.updateHoverClass(),this.rect=y(this,new k(this.el)),y(this,new P(this.chapterEl,this.onDragStart,this.onDragging,(t=>{this.dragging=!1,this.emit(o,this.getCurrentTime(this.getLeft(t)))}))),b(this,this.el,"mousemove",L((t=>this.onMousemove(t))),!0),b(this,this.el,"mouseleave",L(this.onMouseleave),!1),this.setChapters(),this.setMarkers(),this.setHeatMaps(),this.thumbnail=y(this,new I(this.el,this)),this.live&&this.updatePlayed(this.duration),window.ResizeObserver){const t=new ResizeObserver(L((()=>this.updateSize())));t.observe(this.el),y(this,{destroy:()=>t.disconnect()})}}updateSize(){this.rect.update()}updateRotate(t){this.rotate=t,setTimeout((()=>this.updateSize()))}updateDuration(t){this.duration=t||0,function(t){const e=m(t);return e?!isNaN(t)&&isFinite(t):e}(this.duration)||(this.duration=0),this.duration&&(this.updateMarkerPosition(0),this.chapters.forEach((t=>t.updateFlex(this.duration))),this.updateCurrentHeatMap())}updateConfig(t){t&&(Object.assign(this.config,t),this.live=this.config.live,t.duration&&(this.duration=t.duration),t.dot&&this.updateDot(),t.chapters&&this.updateChapters(t.chapters),t.markers&&this.updateMarkers(),t.heatMap&&this.updateHeatMap(t.heatMap),t.thumbnail&&this.thumbnail.updateOptions(t.thumbnail),this.live&&this.updatePlayed(this.duration),null!=t.rotate&&(this.rotate=t.rotate),this.updateSize())}updateMarkerPosition(t){this.markers.forEach((e=>{e.time+=t,e.update(this.duration)}))}updatePlayed(t,e){this.dragging&&!e||!this.duration||(this.chapters.forEach(((e,i)=>{e.updatePlayed(t)&&(this.curChapter=i)})),this.dotEl.style.left=t/this.duration*100+"%")}updateBuffer(t){this.chapters.forEach((e=>e.updateBuffer(t)))}updateHover(t,e){let i=!1;const s=this.chapters.length>1;this.chapters.forEach(((e,r)=>{if(e.updateHover(t)&&s){const t=this.headMaps[r];t&&(this.prevActiveHeat&&(this.prevActiveHeat.style.transform=""),t.el.style.transform="translateY(-2px)",this.prevActiveHeat=t.el),this.prevActiveChapter&&(this.prevActiveChapter.style.transform=""),e.realEl.style.transform="scaleY(2.5)",this.prevActiveChapter=e.realEl,this.curChapter===r&&(this.dotEl.style.transform="scale(1.2) translateY(-50%)",i=!0)}})),s&&!i&&(this.dotEl.style.transform="translateY(-50%)"),null==e&&(e=t/this.duration*this.getWidth()),this.thumbnail.update(t,e,this.getWidth())}updateDot(){const{dot:t}=this.config;this.dotEl.innerHTML="",t&&!0!==t?u(t)?this.dotEl.innerHTML=t:this.dotEl.appendChild(t):this.dotEl.appendChild(x(".ppbar_dot_i"))}updateChapters(t){const e=this.chapters.length,i=this.duration;if(t.length){const s=Math.max(t.length,e);let r,h,a=0;for(let e=0;e<s;e++)r=this.chapters[e],h=t[e],r&&h?r.update(a,h.time||i,i,h.title):r?(r.destroy(),this.chapters[e]=void 0):this.chapters[e]=new B(this.chapterEl,i,a,h.time||i,h.title),h&&(a=h.time||i)}else{this.chapters[0].update(0,i,i);for(let t=1;t<e;t++)this.chapters[t].destroy(),this.chapters[t]=void 0}this.chapters=this.chapters.filter(Boolean)}updateMarkers(){this.markers.forEach((t=>t.destroy())),this.markers=[],this.setMarkers()}updateHoverClass(){const{heatMap:t}=this.config;t&&function(t,e,i,s=""){e=s+e,i?t.classList.add(e):!1===i?t.classList.remove(e):t.classList.toggle(e,i)}(this.heatEl,"ppbar_heat-hover",!!t.hoverShow)}updateHeatMap(t){this.updateHoverClass();const e=t.points;if(!e||!e.length)return this.headMaps.forEach((t=>t.destroy())),void(this.headMaps=[]);const i=this.getHeatItems();if(i){const t=Math.max(this.headMaps.length,i.items.length);let e,s;for(let r=0;r<t;r++)e=this.headMaps[r],s=i.items[r],e&&s?e.update(s,i.max,i.flexes[r]):e?(e.destroy(),this.headMaps[r]=void 0):this.headMaps[r]=new j(this.heatEl,s,i.max,i.flexes[r])}else{const t=Math.max(this.chapters.length,this.headMaps.length);for(let e=0;e<t;e++)this.chapters[e]?this.headMaps[e]||(this.headMaps[e]=new j(this.heatEl)):(this.headMaps[e].destroy(),this.headMaps[e]=void 0)}}updateCurrentHeatMap(){if(this.headMaps.length<2)return;const t=this.getHeatItems();t&&t.items.forEach(((e,i)=>{var s;null==(s=this.headMaps[i])||s.update(e,t.max,t.flexes[i])}))}setChapters(){let t=this.duration;const e=this.config.chapters;if(e&&e.length){if(t=e[e.length-1].time||t,!t)return;const i=document.createDocumentFragment();let s=0;e.forEach(((e,r)=>{this.chapters[r]=new B(i,t,s,e.time||t,e.title),s=e.time||0})),this.chapterEl.appendChild(i)}else this.chapters[0]=new B(this.chapterEl,t,0,t)}setMarkers(){const t=this.config.markers;t&&t.length&&t.forEach(((t,e)=>{this.markers[e]=new O(this,this.markerEl,t)}))}setHeatMaps(){var t;const e=this.config.heatMap;if(!e)return;const i=null==(t=e.points)?void 0:t.length;if(!i||i<2)return;if(!this.duration)return void this.chapters.forEach(((t,e)=>{this.headMaps[e]=new j(this.heatEl)}));const s=this.getHeatItems();s&&s.items.forEach(((t,e)=>{this.headMaps[e]=new j(this.heatEl,t,s.max,s.flexes[e])}))}getHeatItems(){const t=this.duration,e=this.config.heatMap;if(!t||!e)return;const i=e.points,s=i.length;if(!s||s<2)return;const r=null==e?void 0:e.defaultDuration,h=this.chapters,a=h.length>1,n=[[]];let o,l,p,d,c=0,u=0,f=0,g=0,v=0,y=0,C=0;for(let b=0;b<s;b++){if(l=i[b],m(l)?l=i[b]={score:l,duration:r}:l.duration=l.duration||r,null==i[b].duration)return void console.error(`ppbar heatMap.points[${b}].duration is undefined`);i[b].score>u&&(u=i[b].score),g=a?h[c].duration:t,v=l.duration/g*1e3,C=y+v/2,y+=v,a?(f+=l.duration,o=n[c],d=h[c].end,f>d?h[c+1]?(p=f-d,o.push([1e3,l.score]),n[++c]=[[0,l.score]],y=p/h[c].duration*1e3):o.push([1e3,l.score]):o.push([C,l.score])):n[0].push([C,l.score])}return{items:n,flexes:n.map(((t,e)=>a?h[e].el.style.flex:void 0)),max:u}}onMousemove(t){const e=this.getLeft(t),i=this.getCurrentTime(e);this.updateHover(i,e),this.emit(l,i)}getCurrentTime(t){return z(t/this.getWidth())*this.duration}getLeft(t){return this.rotate?90===this.rotate?t.clientY-this.rect.y:this.rect.bottom-t.clientY:t.clientX-this.rect.x}getWidth(){return this.rotate?this.rect.height:this.rect.width}}(T,G);J.updateBuffer(6*R.value),R.onchange=function(){J.updateBuffer(6*R.value)},J.on("markerClick",(function(t){J.updatePlayed(t.time)})),Y.onchange=function(){const t=Y.value?Number(Y.value):0;90===t?(J.updateRotate(90),T.style.width="300px",T.style.transform="rotate(90deg)"):-90===t?(J.updateRotate(-90),T.style.width="300px",T.style.transform="rotate(-90deg)"):(J.updateRotate(0),T.style.width="",T.style.transform="")},U.onchange=function(){J.updateConfig({live:!!U.checked})},W.onchange=function(){W.checked?(q.checked&&(q.checked=!1),J.updateConfig(X)):J.updateConfig(G),J.el.style.setProperty("--primary-color","#f00"),J.updatePlayed(0),J.updateBuffer(6*R.value)},q.onchange=function(){q.checked?(W.checked&&(W.checked=!1),J.updateConfig(K),J.el.style.setProperty("--primary-color","rgba(35,173,229, 1)")):(J.updateConfig(G),J.el.style.setProperty("--primary-color","#f00")),J.updatePlayed(0),J.updateBuffer(6*R.value)};
//# sourceMappingURL=index.8639f0ae.js.map
